<div class="dashboard-container">
  <!-- Sidebar para la lista de dispositivos -->
  <app-sidebar [devices]="devices" [selectedDevice]="selectedDevice" (changeDevice)="changeDevice($event)" (closeSidebar)="closeSidebar()" [showSidebarResponsive]="showSidebarResponsive"></app-sidebar>
  <!-- Contenido principal del dashboard -->
  <div class="main-content">
    <mat-toolbar color="primary" class="custom-toolbar">
      <p (click)="openSidebar()" class="open-menu">Menu</p>
      <span class="spacer"></span>
      <button mat-menu-item (click)="openNotification()" class="icon-button">
          <div class="notification-active">
            <svg width="9" height="9" viewBox="0 0 9 9" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="4.5" cy="4.5" r="3.75" fill="#FF5E6F" stroke="white" stroke-width="1.5"/>
            </svg>
        </div>
          <svg width="20" height="24" viewBox="0 0 20 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17.5998 13.449V9.62358C17.5981 7.91915 16.9947 6.27033 15.8965 4.9691C14.7984 3.66788 13.2763 2.79823 11.5998 2.51416V1.20295C11.5998 0.883906 11.4734 0.577931 11.2483 0.352335C11.0233 0.126739 10.7181 0 10.3998 0C10.0815 0 9.77632 0.126739 9.55128 0.352335C9.32623 0.577931 9.1998 0.883906 9.1998 1.20295V2.51416C7.52333 2.79823 6.00123 3.66788 4.90307 4.9691C3.8049 6.27033 3.20153 7.91915 3.1998 9.62358V13.449C2.49955 13.6971 1.893 14.1564 1.46333 14.7637C1.03366 15.371 0.801892 16.0967 0.799805 16.8413V19.2472C0.799805 19.5662 0.926233 19.8722 1.15128 20.0978C1.37632 20.3234 1.68154 20.4501 1.9998 20.4501H5.7678C6.04414 21.4694 6.64741 22.3693 7.48452 23.0109C8.32163 23.6524 9.34608 24 10.3998 24C11.4535 24 12.478 23.6524 13.3151 23.0109C14.1522 22.3693 14.7555 21.4694 15.0318 20.4501H18.7998C19.1181 20.4501 19.4233 20.3234 19.6483 20.0978C19.8734 19.8722 19.9998 19.5662 19.9998 19.2472V16.8413C19.9977 16.0967 19.7659 15.371 19.3363 14.7637C18.9066 14.1564 18.3001 13.6971 17.5998 13.449ZM5.5998 9.62358C5.5998 8.34741 6.10552 7.12351 7.00569 6.22113C7.90587 5.31874 9.12676 4.81179 10.3998 4.81179C11.6728 4.81179 12.8937 5.31874 13.7939 6.22113C14.6941 7.12351 15.1998 8.34741 15.1998 9.62358V13.2324H5.5998V9.62358ZM10.3998 21.6531C9.98097 21.6505 9.57009 21.5381 9.208 21.3271C8.84591 21.1161 8.54522 20.8137 8.3358 20.4501H12.4638C12.2544 20.8137 11.9537 21.1161 11.5916 21.3271C11.2295 21.5381 10.8186 21.6505 10.3998 21.6531ZM17.5998 18.0442H3.1998V16.8413C3.1998 16.5222 3.32623 16.2162 3.55128 15.9906C3.77632 15.7651 4.08154 15.6383 4.3998 15.6383H16.3998C16.7181 15.6383 17.0233 15.7651 17.2483 15.9906C17.4734 16.2162 17.5998 16.5222 17.5998 16.8413V18.0442Z" fill="#7C7C8D"/>
          </svg>
      </button>

      <button mat-icon-button [routerLink]="['/profile']" class="icon-button" class="image-profile">
        <img src="{{user.imageUrl}}" alt="{{user.firstName}} Image" />
      </button>

      <button mat-menu-item [routerLink]="['/login']" class="icon-button">
        <svg width="27" height="24" viewBox="0 0 27 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19.8889 17L25 12M25 12L19.8889 7M25 12H7.11111M14.7778 17V18.25C14.7778 20.3211 13.0616 22 10.9444 22H5.83333C3.71625 22 2 20.3211 2 18.25V5.75C2 3.67894 3.71625 2 5.83333 2H10.9444C13.0616 2 14.7778 3.67894 14.7778 5.75V7" stroke="#7C7C8D" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </mat-toolbar>

    <div class="dashboard-content">
      <div class="stats-container">
        <mat-card class="card-global dashboard-card battery">
          <div class="icon-card">
            <svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="19" cy="19" r="19" fill="#77F762" fill-opacity="0.1"/>
              <path d="M12.4542 20.1788L20.251 9.3831C20.7668 8.66901 21.8934 9.13914 21.7486 10.008L20.6666 16.5H24.8701C25.55 16.5 25.9437 17.2702 25.5457 17.8213L17.7488 28.6169C17.2331 29.331 16.1065 28.8609 16.2513 27.992L17.3333 21.5H13.1297C12.4499 21.5 12.0561 20.7299 12.4542 20.1788Z" fill="#77F762"/>
            </svg>
          </div>
          <h2>Battery</h2>
          <div class="progress-circle">
            <svg viewBox="0 0 36 36" class="circular-chart">
              <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
              <path class="circle" [attr.stroke-dasharray]="selectedDevice?.battery + ', 100'" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
            </svg>
            <span class="percentage">{{selectedDevice.battery}}%</span>
          </div>
        </mat-card>

        <mat-card class="card-global dashboard-card food">
          <div class="icon-card">
            <svg width="38" height="39" viewBox="0 0 38 39" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="19" cy="19.5" r="19" fill="#FF7E86" fill-opacity="0.1"/>
              <path d="M19.4164 27.4215L22.5197 24.3182L21.2237 23.0054L19.6892 24.5399L19.6891 14.6503L21.2236 16.1848L22.5366 14.8719L19.4162 11.7686C19.0581 11.4105 18.4614 11.4105 18.1033 11.7686L15 14.8719L16.313 16.1848L17.8475 14.6503V24.5399L16.313 23.0054L15 24.3183L18.1033 27.4216C18.4784 27.7795 19.0581 27.7795 19.4162 27.4214L19.4164 27.4215Z" fill="#FF7E86"/>
            </svg>
          </div>
          <h2>Food</h2>
          <div class=" progress-circle">
            <svg viewBox="0 0 36 36" class="circular-chart">
              <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
              <path class="circle" [attr.stroke-dasharray]="selectedDevice?.food + ', 100'" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
            </svg>
            <span class="percentage">{{selectedDevice.food}}%</span>
          </div>
        </mat-card>

        <mat-card class="card-global dashboard-card water">
          <div class="icon-card">
            <svg width="38" height="39" viewBox="0 0 38 39" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="19" cy="19.5" r="19" fill="#A162F7" fill-opacity="0.1"/>
              <path d="M19.3835 11.6191C19.3187 11.5435 19.2243 11.5 19.1248 11.5C19.0254 11.5 18.9309 11.5435 18.8662 11.6191C18.6247 11.9015 13 18.6152 13 21.8272C13.018 23.4349 13.6729 24.9699 14.8212 26.0951C15.9695 27.2204 17.5172 27.8442 19.1249 27.8298C20.7326 27.8442 22.2804 27.2204 23.4287 26.0951C24.577 24.9699 25.2319 23.435 25.2499 21.8272C25.2499 18.6152 19.6252 11.9014 19.3837 11.6191H19.3835ZM21.3196 25.9447C21.2727 25.9701 21.2199 25.983 21.1665 25.982C21.0097 25.9811 20.8738 25.8732 20.8375 25.7207C20.8011 25.5681 20.8738 25.4104 21.0134 25.339C21.669 25.015 22.2216 24.5149 22.6092 23.8947C22.9969 23.2744 23.2042 22.5586 23.2081 21.8273C23.2081 21.6394 23.3604 21.4871 23.5484 21.4871C23.7363 21.4871 23.8886 21.6394 23.8886 21.8273C23.8852 22.6845 23.643 23.5237 23.1892 24.2511C22.7354 24.9783 22.0881 25.5647 21.3196 25.9446L21.3196 25.9447Z" fill="#A162F7"/>
            </svg>
          </div>
            
          <h2>Water</h2>
          <div class="progress-circle">
            <svg viewBox="0 0 36 36" class="circular-chart">
              <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
              <path class="circle" [attr.stroke-dasharray]="selectedDevice?.water + ', 100'" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
            </svg>
            <span class="percentage">{{selectedDevice.water}}%</span>
          </div>
        </mat-card>

        <mat-card class="card-global dashboard-card stat-card add-device" (click)="invertShowPopupAddDevice()">
          <mat-icon>add</mat-icon>
          <h2>Add <br> Device</h2>
        </mat-card>
      </div>

      <div class="stats-cam">
        <mat-card class="card-global dashboard-card  feeding-habits">
          <mat-card-content>
            <div class="chart-container">
              <app-feeding-habits-chart></app-feeding-habits-chart>
            </div>
          </mat-card-content>
        </mat-card>
  
        <mat-card class="card-global dashboard-card live-cam">
          <p>Live Cam</p>

          <mat-card-content>
            <img [src]="gifPath" alt="Transmisión de cámara en vivo">
          </mat-card-content>
        </mat-card>
      </div>

      <div class="list-pets">
        <mat-card class="pet-card card-global dashboard-card" *ngFor="let pet of pets" (click)="selectEditPet(pet)">
          <div class="image-container">
            <div class="pet-species">
              Edit
            </div>
            <div class="pet-info">
              <h3>{{ pet.name }}</h3>
              <p>{{ pet.age }} years</p>
              <p>{{ pet.weight }} kg</p>
            </div>
          </div>
        </mat-card>
        
        <mat-card class="card-global dashboard-card stat-card add-device" (click)="invertShowPopupAddPet()">
          <mat-icon>add</mat-icon>
          <h2>Add <br> Pet</h2>
        </mat-card>
      </div>

        
      </div>
    </div>
  </div>

  <app-add-pet *ngIf="showPopupAddPet" (invertShowPopupAddPet)="invertShowPopupAddPet()" (addPet)="addPet($event)"></app-add-pet>
  <app-edit-pet *ngIf="showPopupEditPet" (invertShowPopupEditPet)="invertShowPopupEditPet()" (editPet)="editPet($event)" [selectedPet]="selectedPet"></app-edit-pet>
  <app-add-device *ngIf="showPopupAddDevice" (invertShowPopupAddDevice)="invertShowPopupAddDevice()" (addDevice)="addDevice($event)"></app-add-device>

